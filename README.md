# CQU-CPP-Project-ATM (重庆大学 程序设计基础课程 项目作业 ATM模拟程序的设计与实现)

- 运用面向对象程序设计思想，基于命令行界面设计并实现一个 ATM 模拟程序，模拟常见的 ATM 功能

一个基于 C++ 开发的 ATM 银行模拟系统，实现了完整的银行 ATM 功能，并集成了**高级安全特性和反逆向工程保护机制**等高级安全特性。本项目为 C++ 程序设计基础课程的作业示范项目，展示了从基础功能实现到企业级安全特性的完整技术栈。**包含示范项目报告 `ATM.docx`**。

- 仅供学习交流使用，请勿用于实际金融业务

## 功能特性

### 基本业务功能

- **用户认证系统**：支持账号密码登录，包含锁卡机制
- **账户管理**：自动检测新账号并引导创建，支持账户信息的持久化存储
- **资金交易**：支持存款、取款、转账等完整银行业务流程
- **交易限额控制**：单笔限额5000元，单日累计限额20000元
- **交易记录追踪**：完整记录所有交易历史，包括日期、类型、金额、余额
- **密码管理**：支持用户自主修改密码，采用SHA-256哈希存储

### 基本界面显示

- **多语言界面**：支持中文（UTF-8/GBK自动检测）和英文界面
- **智能编码适配**：自动检测控制台编码环境，确保中文正常显示
- **友好的交互界面**：清晰的菜单导航和操作提示

## 创新亮点

本项目区别于常见的ATM模拟程序，具有以下创新特性：

### 1. 高级安全防护体系

#### 反逆向工程保护

- **字符串混淆保护**：采用XOR加密技术混淆关键字符串，防止静态分析
- **反调试检测**：运行时检测调试器，防止动态分析和代码破解
- **虚假代码分支混淆**：插入虚假逻辑分支，增加逆向分析难度
- **内存加密保护**：敏感数据在内存中加密存储，防止内存转储攻击

#### 数据加密

- **AES-256加密**：采用工业标准的AES-256算法加密敏感数据
- **SHA-256密码哈希**：密码采用SHA-256单向哈希存储
- **运行时密钥初始化**：加密密钥在运行时动态生成，避免硬编码风险
- **内存清理机制**：敏感数据使用后立即清理内存，防止残留

### 2. 完善功能实现

- **新账户自动识别**：系统自动检测不存在的账号并引导用户创建
- **临时文件写入机制**：采用临时文件+原子替换策略，确保数据写入完整性

### 3. 专业的技术架构

#### 模块化设计

- **职责分离**：清晰的模块划分（认证、账户、交易、安全、语言）
- **高内聚低耦合**：各模块独立实现，接口清晰
- **可扩展性**：便于后续功能扩展和维护

#### C++ 特性

- **充分利用 C++11**：使用智能指针、Lambda表达式、自动类型推导等特性
- **异常与健壮性**：完善的异常处理机制，确保程序健壮性
- **RAII 原则**：资源管理遵循 RAII 原则，防止资源泄露

## 技术架构

### 核心数据结构

#### BankAccount 类
```
- 账号（19位）
- 姓名
- 身份证号
- 密码哈希（SHA-256）
- 账户余额
- 锁定状态
- 交易记录列表
- 每日取款限额
```

#### Transaction 结构
```
- 交易日期时间
- 交易类型（存款/取款/转账）
- 交易金额
- 交易后余额
```

#### SecureString 类
```
- AES-256加密的字符串容器
- 自动加密/解密
- 内存自动清理
```

### 主要功能模块

1. **用户认证模块**：账号验证、密码验证、登录失败计数
2. **账户管理模块**：账户创建、信息存储、数据加载
3. **交易处理模块**：存款、取款、转账、限额检查
4. **安全控制模块**：反调试、加密、内存保护
5. **多语言支持模块**：编码检测、字符串管理
6. **交易记录模块**：记录生成、历史查询

## 编译和运行

### 主要依赖

- OpenSSL
- windows.h
- tlhelp32.h

### 编译环境要求

- C++11或更高版本编译器（GCC 4.8+、Clang 3.3+、MSVC 2013+）
- 推荐使用 MSYS2 (mingw-w64) 编译环境
- 支持的操作系统：Windows

### 编译命令
#### Windows (MinGW)
```bash
g++ -std=c++11 -O2 -Wall -o ATM.exe ATM.cpp -lssl -lcrypto -lws2_32 -lgdi32
```

## 使用说明

### 初始账户

系统不提供默认账户，首次使用需要创建新账户：
1. 运行程序后输入任意19位数字作为账号
2. 系统检测到账号不存在，自动引导创建
3. 按提示输入姓名、身份证号、密码等信息
4. 设置初始存款金额

### 功能操作

#### 登录
1. 输入19位账号
2. 输入密码
3. 密码错误3次将锁定账户

#### 查询余额
登录后选择查询功能，显示当前账户余额

#### 存款
1. 选择存款功能
2. 输入存款金额
3. 确认后更新余额

#### 取款
1. 选择取款功能
2. 输入取款金额（单笔≤5000，单日累计≤20000）
3. 确认后更新余额

#### 转账
1. 选择转账功能
2. 输入目标账号
3. 输入转账金额
4. 确认后完成转账

#### 修改密码
1. 选择密码修改功能
2. 输入原密码
3. 输入新密码并确认
4. 密码立即生效

#### 查看交易记录
选择交易记录功能，显示所有历史交易详情

## 技术特点总结

本项目不仅实现了ATM系统的基本功能，更在安全性、可靠性、可维护性方面达到了实际应用水平：

- **安全性**：集成反调试、数据加密、密码哈希等多重安全机制
- **可靠性**：临时文件写入、异常处理、数据完整性保护
- **专业性**：企业级功能设计、完整的交易追踪、限额控制
- **可维护性**：模块化设计、代码规范、职责分离
- **用户体验**：多语言支持、智能编码适配、友好交互界面

---

## 开源许可

本项目基于 0BSD 协议开源，无需标注作者，无需保留协议信息。